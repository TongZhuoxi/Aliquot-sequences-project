# Question: Find a way to detect loops. (Thereâ€™s a little bit to this â€“ look at the sequence starting at 562 to see why.)
# Write up:
# We have been asked to find a way to detect loops within aliquot sequences. Our thought process essentially consisted of 
# compiling a list of terms from the aliquot sequence of n, which DON'T repeat. For every next term in the sequence, we then 
# would check it against this list that we're constantly adding to. If it's not in the list, then we add it to the list 
# because it hasn't repeated! If it is in the list, then this term has repeated and created a loop. We exit the while loop 
# and print out the sequence up to the term before it repeats and make it known the number the sequence loops from.

def detect_loop(n):

    #We want to create a list of the values in the aliquot sequence for n so we know if a value repeats
    repeats = [n]

    #Compute the next term by using the previously defined function s(n)
    next_term = s(n)

    #We then create a loop for when the next term in the sequence is NOT repeated
    while next_term not in repeats:
        #If the next term is not in our repeats list, we add this term to our repeats list    
        repeats.append(next_term)
        #We then make our current term the term we just used
        n = next_term
        #We then compute the next term using function s(n) and then repeat this loop until a term repeats
        next_term = s(n)


    #A term has repeated so it exits the loop and prints the repeating term
    print("The sequence now loops at " + str(next_term))
    return repeats

# nicoles code - now doesnt detect loops if it reaches 0, and stops if it reaches max iterations or 10^9 
# reaching iterations issue fixed

def detect_loop_tf(n, limit):

    #We want to create a list of the values in the aliquot sequence for n so we know if a value repeats
    repeats = [n]

    #Compute the next term by using the previously defined function s(n)
    next_term = s(n)

    iterations = 1   # count steps taken

    #We then create a loop for when the next term in the sequence is NOT repeated
    while next_term not in repeats:

        # terminate at 0
        if next_term == 0:
            return 

        # terminate above limit
        if next_term > limit:
            return 

        # terminate at 30 iterations
        if iterations >= 30:
            return 

        #We then add this term to our repeats list 
        repeats.append(next_term)

        #We then make our current term the term we just used
        n = next_term

        #We then compute the next term using function s(n) and then repeat this loop until a term repeats
        next_term = s(n)

        iterations += 1

    #A term has repeated so it exits the loop and prints the repeating term
    return True

detect_loop_tf(5, 10**9)
